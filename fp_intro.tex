\documentclass{beamer}

\usetheme{Singapore}
%%\usetheme{Berkeley}
%% \usetheme{Marburg}
%% \usetheme{PaloAlto}

\usecolortheme{dolphin}

\title[Functional Programming]{An Introduction to Functional Programming}
\author{Andreas Pauley -- @apauley \\ Lambda Luminaries}
\institute{Joburg Centre for Software Engineering}
\date{February 17, 2014}

\usepackage[utf8]{inputenc}
\usepackage{graphicx}

\usepackage{pgfplots}

\pgfplotsset{mypgfstyle/.append style={axis x line=middle, axis y line=
middle, xlabel={$x$}, ylabel={$y$}}}

\usepackage{minted}

\usepackage{hyperref}

\AtBeginSection[]
{
  \begin{frame}
    \frametitle{Table of Contents}
    \tableofcontents[currentsection]
  \end{frame}
}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Lambda Luminaries -- @lambdaluminary}
  We meet once a month, on the second Monday of the month.

  \includegraphics[scale=0.3]{img/LambdaLuminariesScreenShot2013-08-09.png}

  \vskip5mm

  \url{http://www.meetup.com/lambda-luminaries/}
\end{frame}

\begin{frame}{Jemstep}
  \includegraphics[scale=2]{img/Jemstep_HD_RGB.eps}

  Retirement portfolio analysis in Scala.

  \vskip5mm

  \url{http://www.jemstep.com/}
\end{frame}

\section{Introduction}

\begin{frame}{A word from the wise}
  \begin{exampleblock}{}
    {\Large ``
      No matter what language you work in, programming
      in a functional style provides benefits.
      You should do it whenever it is convenient, and you
      should think hard about the decision when it isn’t convenient.
      ''}
    \vskip5mm
    \hspace*\fill{\small--- John Carmack, ID Software \cite{carmack}}
  \end{exampleblock}
\end{frame}

\begin{frame}{Quake}
  \includegraphics[scale=0.4]{img/quake.png}
\end{frame}

\section{Definition}

\begin{frame}{}

  {\Large So what exactly is Functional Programming?}

\end{frame}

\begin{frame}{Functional Programming, noun:}

  \begin{exampleblock}{}
    {\Huge
      Functional Programming is a list of things you CAN’T do.
      }
    \vskip5mm
    \hspace*\fill{\small \cite{pauleyfp}}
  \end{exampleblock}
\end{frame}

\begin{frame}

In functional programming:

  \begin{itemize}[<+->]
  \item You can't vary your variables.
  \item No while/for loops, sorry.
    \mint{java}|for ( int i=1; i <= 3 ; i++ )|
  \item You can't have mutable data structures.
  \item You can't have any side-effects.
  \end{itemize}
\end{frame}

\begin{frame}{Are you kidding me?}
  How can anyone program like this???
  \includegraphics[scale=0.3]{img/sadbaby.png}
\end{frame}

\begin{frame}{GOTO 10}
    This sounds like
  \begin{exampleblock}{}
    {\Large ``You can't have GOTO statements''}
  \end{exampleblock}
  \vskip5mm
  \hspace*\fill{\small See Hughes and Dijkstra \cite{whyfp, dijkstra}}

  \begin{itemize}[<+->]
  \item Also framed in the negative (you can't).
  \item In hindsight we don't really need GOTO's.
  \item In hindsight it is not about what you cannot do.
  \end{itemize}
\end{frame}

\begin{frame}{Structured Programming and Functional Programming}
  \begin{description}[<+->]
  \item[Structured Programming] introduced subroutines with fixed
    entry/exit points (instead of GOTO's), resulting in improved
    modularity.
  \item[Functional Programming] provides similar important benefits --
    more about this later.
  \end{description}
\end{frame}

\begin{frame}{}

  {\Large We need a better definition for Functional Programming.}

\end{frame}

\begin{frame}{Functional Programming, noun:}

\begin{exampleblock}{}
  {\Large ``
  Functional programming is so called because a program consists entirely of functions.
  ''}
  \vskip5mm
  \hspace*\fill{\small--- John Hughes, Why Functional Programming
    Matters \cite[p.~1]{whyfp}}
\end{exampleblock}
\end{frame}

\begin{frame}{}

  {\Large OK... so what exactly is a function?}

\end{frame}

\section{Function Recap}

\begin{frame}{An example function}

  {\Huge $f(x) = 2x^2 - 2x + 3$}

  \begin{tikzpicture}
    \begin{axis}[mypgfstyle]
      \addplot[domain=-1:3, color=blue] {2*(x^2) - (2*x) + 3};
    \end{axis}
  \end{tikzpicture}

\end{frame}

\begin{frame}{Variables in functions}

  {\Huge $f(x) = 2x^2 - 2x + 3$}

  \vskip5mm

When we evaluate the function:
  \begin{itemize}[<+->]
    \item $f(2) = 8 - 4 + 3 = 7$
    \item The value of $x$ will not change inside the function body.
    \item No $x = 2$ and later $x = 71$ in the same function body.
    \item Same input, same output. Every time.
    \item In other words, we can replace any occurrence of $f(2)$ with
      $7$ (Referential Transparency)
  \end{itemize}
\end{frame}


\begin{frame}{Functions can call other functions}

  {\Huge $g(x) = f(x) + 1$}

\end{frame}

\begin{frame}[fragile]{Values are functions}

  {\large Constant values are just functions with no input parameters}

  \vskip5mm

  {\Huge $x = 42$}

  \vskip5mm

Python function definition:
  \begin{minted}{python}
def x():
    return 42
  \end{minted}

Haskell function definition:
  \begin{minted}{haskell}
x = 42
  \end{minted}

\end{frame}

\begin{frame}{Functions can be composed}

  {\Huge $h(x) = (f \circ g)(x) = f(g(x))$\\
  \vskip5mm
  or\\
  \vskip5mm
  $h = f \circ g$}

\end{frame}

\begin{frame}{Higher-order Functions}

  {\Large Functions can take functions as input and/or return
    functions as the result.}

  \vskip5mm

  {\Huge $h(f, g, x) = f(x) + g(2)$}

\end{frame}

\begin{frame}{Higher-order Functions}

  {\Large The derivative of $f(x)$ returns another function.}

  \vskip5mm

  {\Large $f(x) = 2x^2 - 2x + 3$}\\
  {\Large $\frac{d}{dx} f(x) = 4x - 2$}

  \begin{tikzpicture}
    \begin{axis}[mypgfstyle]
      \addplot[domain=-1:3, color=blue] {2*(x^2) - (2*x) + 3};
      \addplot[domain=-1:3, color=magenta] {4*x - 2};
    \end{axis}
  \end{tikzpicture}

\end{frame}

\begin{frame}[fragile]{A functional program consists entirely of functions}

  \inputminted[firstline=6,lastline=15]{python}{code/python/justfunctions.py}

  \begin{verbatim}
$ ./justfunctions.py Hello from Python
2014-02-15 10:36:42.062697 Hello-from-Python
  \end{verbatim}

\end{frame}

\begin{frame}[fragile]{A functional program consists entirely of functions}

  \inputminted[firstline=5]{haskell}{code/haskell/justfunctions.hs}

  \begin{verbatim}
$ ./justfunctions Hello from Haskell
2014-02-15 08:36:50.822728 UTC Hello-from-Haskell
  \end{verbatim}

\end{frame}

\section{Common Idioms}
\subsection{Recursion}

\begin{frame}[fragile]{Recursive function: Haskell}

  \inputminted[lastline=3]{haskell}{code/haskell/doubleall_recursion.hs}

  \vskip5mm

Example use in the interactive interpreter:
  \begin{minted}{haskell}
Prelude Main> doubleAll [8,2,3]
[16,4,6]
  \end{minted}

\end{frame}

\begin{frame}[fragile]{Recursive function: Python}

  \inputminted[firstline=3,lastline=9]{python}{code/python/doubleall_recursion.py}

  \vskip5mm

Example use in the interactive interpreter:

  \begin{minted}{python}
>>> doubleAll([8,2,3])
[16, 4, 6]
  \end{minted}

\end{frame}

\begin{frame}{An iterative version in Python}

  \inputminted[firstline=3]{python}{code/python/doubleall_iterative.py}

\end{frame}

\subsection{Pattern Matching}

\begin{frame}{Pattern Matching: Haskell}

  \inputminted[lastline=3]{haskell}{code/haskell/doubleall_recursion.hs}

\end{frame}

\subsection{Higher-order Functions}

\begin{frame}{Higher-order functions: Python}

  {\large $f(x) = 2x^2 - 2x + 3$}\\
  {\large $g(x) = f(x) + 1$}\\
  {\large $h(f1, f2) = f1(3) + f1(2)$}\\

  \vskip5mm

  \inputminted[firstline=3,lastline=10]{python}{code/python/higher_order.py}

\end{frame}

\begin{frame}{Higher-order functions: Haskell}

  {\large $f(x) = 2x^2 - 2x + 3$}\\
  {\large $g(x) = f(x) + 1$}\\
  {\large $h(f1, f2) = f1(3) + f1(2)$}\\

  \vskip5mm

  \inputminted[lastline=5]{haskell}{code/haskell/higher_order.hs}

\end{frame}

\section{Map, Filter, Fold}

\begin{frame}{3 Basic List Operations}

  \begin{description}[<+->]
  \item[Map] Convert each element of a list into some other value.
    Example: Convert a list of bank accounts to a list of balance amounts.
  \item[Filter] Get a subset of a list based on some condition.
    Example: Show only those accounts with a balance above one million.
  \item[Fold] Reduce a list of items to a single value.
    Example: Get the sum of a list of numbers.
    Or reduce a list of bank accounts to a map of balances per bank.
  \end{description}

\end{frame}

\begin{frame}[fragile]{Map}

  Apply a function to each element of a list, and you get a new list.
  \vskip5mm
  \begin{tikzpicture}[
      bluesquare/.style={rectangle,  draw=blue!60, fill=blue!5, very
        thick, minimum size=1cm},
      greensquare/.style={rectangle, draw=green!60, fill=green!5, very thick, minimum size=1cm}]

    \node[bluesquare] (a1) at (0,3) {$a_1$};
    \node[bluesquare] (a2) at (1,3) {$a_2$};
    \node[bluesquare] (a3) at (2,3) {$a_3$};
    \node[bluesquare] (ad) at (3,3) {$...$};
    \node[bluesquare] (an) at (4,3) {$a_n$};

    \node[greensquare] (b1) at (0,0) {$b_1$};
    \node[greensquare] (b2) at (1,0) {$b_2$};
    \node[greensquare] (b3) at (2,0) {$b_3$};
    \node[greensquare] (bd) at (3,0) {$...$};
    \node[greensquare] (bn) at (4,0) {$b_n$};

    \node (fa1) at (0,1.5) {$f(a_1)$};
    \node (fan) at (4,1.5) {$f(a_n)$};

    \draw[thick]    (a1)  -- (fa1);
    \draw[->,thick] (fa1) -- (b1);

    \draw[->,thick] (a2) -- (b2);
    \draw[->,thick] (a3) -- (b3);

    \draw[thick]    (an)  -- (fan);
    \draw[->,thick] (fan) -- (bn);

  \end{tikzpicture}

\end{frame}

\begin{frame}[fragile]{Map}

The builtin Haskell map function:

  \begin{minted}{haskell}
map :: (a -> b) -> [a] -> [b]
map _ [] = []
map f (x:xs) = f x : map f xs
  \end{minted}

\end{frame}

\begin{frame}[fragile]{Map}

The builtin Haskell map function:
  \begin{minted}{haskell}
map :: (a -> b) -> [a] -> [b]
map _ [] = []
map f (x:xs) = f x : map f xs
  \end{minted}

  \vskip5mm

Hmmm, looks very similar to our previous doubleAll function:

  \inputminted[lastline=3]{haskell}{code/haskell/doubleall_recursion.hs}
\end{frame}

\begin{frame}[fragile]{Map}

So our doubleAll can actually be simplified.

  \vskip5mm

In Haskell:
  \begin{minted}{haskell}
doubleAll = map (*2)
  \end{minted}

  \vskip5mm

In Python:
  \inputminted[firstline=3,lastline=4]{python}{code/python/doubleall_map.py}
\end{frame}

\begin{frame}[fragile]{Map}

  \begin{minted}{haskell}
doubleAll :: Num a => [a] -> [a]
doubleAll = map (*2)
  \end{minted}

  \begin{tikzpicture}[
      bluesquare/.style={rectangle,  draw=blue!60, fill=blue!5, very
        thick, minimum size=1cm},
      greensquare/.style={rectangle, draw=green!60, fill=green!5, very thick, minimum size=1cm}]

    \node[bluesquare] (a1) at (0,3) {$8$};
    \node[bluesquare] (a2) at (1,3) {$2$};
    \node[bluesquare] (a3) at (2,3) {$3$};

    \node[greensquare] (b1) at (0,0) {$16$};
    \node[greensquare] (b2) at (1,0) {$4$};
    \node[greensquare] (b3) at (2,0) {$6$};

    \node (fa1) at (0,1.5) {$*2$};
    \node (fa2) at (1,1.5) {$*2$};
    \node (fa3) at (2,1.5) {$*2$};

    \draw[thick]    (a1)  -- (fa1);
    \draw[->,thick] (fa1) -- (b1);

    \draw[thick]    (a2)  -- (fa2);
    \draw[->,thick] (fa2) -- (b2);

    \draw[thick]    (a3)  -- (fa3);
    \draw[->,thick] (fa3) -- (b3);

  \end{tikzpicture}

\end{frame}

\begin{frame}{Account Data}

  \inputminted[firstline=3,lastline=3]{haskell}{code/haskell/accounts.hs}
  \inputminted[firstline=19,lastline=22]{haskell}{code/haskell/accounts.hs}

\end{frame}

\begin{frame}{Account Data}

  \inputminted[firstline=28,lastline=43,gobble=11]{haskell}{code/haskell/accounts.hs}

\end{frame}

\begin{frame}[fragile]{Map}

Map type signature:
  \begin{minted}{haskell}
map :: (a -> b) -> [a] -> [b]
  \end{minted}

  \vskip5mm

Map on account data:
  \inputminted[firstline=45,lastline=46]{haskell}{code/haskell/accounts.hs}

  \vskip5mm

balance type signature:
  \begin{minted}{haskell}
balance :: Account -> Amount
  \end{minted}

  \vskip5mm

Output:
  \begin{verbatim}
*Main> balances accounts
[R123000.23,R5782347.99,R100.0,R2937361.45]
  \end{verbatim}

\end{frame}

\begin{frame}[fragile]{Filter}

Filter type signature:
  \begin{minted}{haskell}
filter :: (a -> Bool) -> [a] -> [a]
  \end{minted}

  \vskip5mm

Filter on account data:
  \inputminted[firstline=48,lastline=52]{haskell}{code/haskell/accounts.hs}

  \vskip5mm

Output:
  \begin{verbatim}
*Main> loaded accounts
[FNB 6868773585 (J. Black) R5782347.99,
 FNB 6584539813 (S. Jones) R2937361.45]
  \end{verbatim}

\end{frame}


\begin{frame}[fragile]{Fold}

Fold type signature:
  \begin{minted}{haskell}
foldl :: (a -> b -> a) -> a -> [b] -> a
  \end{minted}

  \vskip5mm

Fold on account data:
  \inputminted[firstline=54,lastline=55]{haskell}{code/haskell/accounts.hs}

  \vskip5mm

Output:
  \begin{verbatim}
*Main> balanceSum accounts
R8842809.67
  \end{verbatim}

\end{frame}

\begin{frame}[fragile]{Fold}

  \inputminted[firstline=54,lastline=59]{haskell}{code/haskell/accounts.hs}

Output:
  \begin{verbatim}
*Main> balancesPerBank accounts
fromList [(ABSA,R123100.23),(FNB,R8719709.44)]
  \end{verbatim}

\end{frame}

\begin{frame}{Fold}

  \inputminted[firstline=57,lastline=71]{haskell}{code/haskell/accounts.hs}

\end{frame}

\section{Comparison}

\begin{frame}

  In imperative programming:

  \begin{itemize}[<+->]
  \item Your variables can change out underneath you!
  \item You have to write your own loops for the most basic list operations!
  \item Your data structures are mutable!
  \item You have to use locks to be thread-safe!
  \item You have to defensively make copies of data to prevent bugs!
  \item You have to defensively check for null values!
  \item Code is generally riddled with side-effects!
  \end{itemize}
\end{frame}

\begin{frame}{Are you kidding me?}
  How can anyone program like this???
  \includegraphics[scale=0.3]{img/sadbaby.png}
\end{frame}

\section{Advantages}

\begin{frame}{Perlisism \#19}

\begin{exampleblock}{}
  {\Large ``
    A language that doesn't affect the way you think about programming, is not worth knowing.
  ''}
  \vskip5mm
  \hspace*\fill{\small--- Alan Perlis\cite{perlis19}}
\end{exampleblock}

\end{frame}

\begin{frame}{Advantages of Functional Programming}

  \begin{itemize}[<+->]
  \item Changes the way you think about programming and problem solving.
  \item Improves the level of code re-use we can get.
  \item Improves the level of patterns and abstractions we can achieve, eg.
    with higher-order functions, function composition, type classes.
  \item Lock-free concurrency.
  \item Raises the bar on automated testing - QuickCheck.
  \item More effective reasoning about code.
  \item Declare possible Null values explicitly if you need them.
    Goodbye NullPointerException (mostly).
  \end{itemize}

\end{frame}

\section{Disdvantages}

\begin{frame}{Disadvantages of Functional Programming}

  \begin{itemize}[<+->]
  \item Steep learning curve.
  \item There are some very cryptic concepts.
  \item Order of execution may be difficult to reason about in a lazy language.
  \end{itemize}

\end{frame}


\begin{frame}{Unfamiliar Territory}

  {\Large Functional Programming is unfamiliar territory for most.}

\begin{exampleblock}{}
  {\Large ``
    If you want everything to be familiar you will never learn anything new.
  ''}
  \vskip5mm
  \hspace*\fill{\small--- Rich Hickey, author of Clojure\cite{hickey}}
\end{exampleblock}

\end{frame}

\section{Industry Use}

\begin{frame}{Companies In South Africa}

  \begin{description}[<+->]
  \item[Jemstep, Sandton] Using Scala for Fund Analysis
  \item[Allan Gray, Cape Town] Using Scala for backend logic and system integration.
  \item[Yuppiechef, Cape Town] Using Clojure for their Warehouse
    Management System.
  \item[Cognician, Cape Town] Using Clojure to create coaching/learning modules.
  \item[Eldo Energy, Johannesburg] Using Clojure for automated meter
    reading and intelligent monitoring of consumer energy.
  \item[Rheo Systems, Pretoria] Using Clojure for supply chain integration.
  \end{description}

\end{frame}

\begin{frame}{Companies In South Africa}

  \begin{description}[<+->]
  \item[Pattern Matched Technologies, Midrand] Using Erlang for all systems,
    eg. processing high volumes of financial transactions.
  \item[Effective Control Systems, Kyalami] Using Erlang for printer
    management.
  \item[Mira Networks, Somerset West] Using Erlang for billing
    administration and mobile development.
  \item[Kotive] Using Scala for designing workflow processes.
  \end{description}

\end{frame}

\section{Now what?}

\begin{frame}{Lambda Luminaries -- @lambdaluminary}
  \framesubtitle{Local functional programming user group}
  We meet once a month, on the second Monday of the month.

  \url{http://www.meetup.com/lambda-luminaries/}
  \includegraphics[scale=0.3]{img/LambdaLuminariesScreenShot2013-08-09.png}
\end{frame}

\begin{frame}{Online Courses}

  \begin{thebibliography}{10}
    \bibitem{fpthinkingnealford}
      Functional Thinking by Neal Ford
      \newblock O' Reilly
      \newblock \url{http://shop.oreilly.com/product/0636920030393.do}
    \bibitem{fpinscalacourse}
      Functional Programming Principles in Scala
      \newblock EPFL University
      \newblock \url{https://www.coursera.org/course/progfun}
    \bibitem{fpcomplete}
      School of Haskell
      \newblock FP Complete
      \newblock \url{https://www.fpcomplete.com/school}
    \bibitem{proglangcourse}
      Programming Languages
      \newblock University of Washington
      \newblock \url{https://www.coursera.org/course/proglang}
  \end{thebibliography}

\end{frame}

\begin{frame}{Books}

  \begin{thebibliography}{10}
    \bibitem{haskellforgreatgood}
      Miran Lipovača
      \newblock Learn You a Haskell for Great Good!
      \newblock \url{http://learnyouahaskell.com/}
    \bibitem{erlangforgreatgood}
      Fred Hébert
      \newblock Learn You Some Erlang for Great Good!
      \newblock \url{http://learnyousomeerlang.com/}
    \bibitem{rwocaml}
      Yaron Minski, Anil Madhavapeddy, Jason Hickey
      \newblock Real World OCaml
      \newblock \url{https://realworldocaml.org/}
    \bibitem{fpinscalabook}
      Paul Chiusano, Rúnar Bjarnason
      \newblock Functional Programming in Scala
      \newblock \url{http://www.manning.com/bjarnason/}
  \end{thebibliography}

\end{frame}

\begin{frame}[allowframebreaks]{References}
  \begin{thebibliography}{10}
    \bibitem{whyfp}
      John Hughes
      \newblock Why Functional Programming Matters
      \newblock \url{http://www.cs.kent.ac.uk/people/staff/dat/miranda/whyfp90.pdf}
    \bibitem{carmack}
      John Carmack
      \newblock Functional Programming in C++
      \newblock \url{http://www.altdevblogaday.com/2012/04/26/functional-programming-in-c/}
    \bibitem{dijkstra}
      Edsger W. Dijkstra
      \newblock Go To Statement Considered Harmful
      \newblock \url{http://www.u.arizona.edu/~rubinson/copyright_violations/Go_To_Considered_Harmful.html}
    \bibitem{mfeathers}
      Tweet by Michael Feathers
      \newblock \url{https://twitter.com/mfeathers/status/29581296216}
    \bibitem{perlis19}
      Alan Jay Perlis
      \newblock \url{http://www.cs.yale.edu/quotes.html}
    \bibitem{hickey}
      Rich Hickey
      \newblock \url{http://www.infoq.com/presentations/Simple-Made-Easy}
    \bibitem{pauleyfp}
      Andreas Pauley
      \newblock An Introduction to Functional Programming
      \newblock \url{https://github.com/apauley/fp_presentation}
  \end{thebibliography}
\end{frame}

\end{document}
